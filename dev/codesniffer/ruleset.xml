<?xml version="1.0"?>
<ruleset name="Dolibarr">
	<description>Dolibarr coding standard.</description>

    <!-- Avoid PHPCS error when no code is found within a file -->
	<rule ref="Internal.NoCodeFound">
		<severity>0</severity>
	</rule>

    <!-- Dolibarr follows PSR-2 with 2 exceptions. Check http://wiki.dolibarr.org/index.php/Language_and_development_rules#PHP_Norms -->
    <rule ref="PSR2">
        <!-- Disallow usage of space -->
        <exclude name="Generic.WhiteSpace.DisallowTabIndent" />
        <exclude name="Generic.WhiteSpace.ScopeIndent" />
        <!-- Disallow warnings because of line length -->
        <exclude name="Generic.Files.LineLength" />
        <!-- Dolibarr does not follow namespaces yet... -->
        <exclude name="PSR1.Classes.ClassDeclaration" />
    </rule>

    <!-- Disallow usage of space indenting -->
    <rule ref="Generic.WhiteSpace.DisallowSpaceIndent" />

    <!-- Code analysis tests -->
	<rule ref="Generic.CodeAnalysis.EmptyStatement" />
	<rule ref="Generic.CodeAnalysis.EmptyStatement.NotAllowed">
		<severity>0</severity>
	</rule>
	<rule ref="Generic.CodeAnalysis.EmptyStatement.NotAllowedWarning">
		<severity>0</severity>
	</rule>
    <rule ref="Generic.CodeAnalysis.ForLoopWithTestFunctionCall" />
    <rule ref="Generic.CodeAnalysis.JumbledIncrementer" />
    <rule ref="Generic.CodeAnalysis.UnconditionalIfStatement" />
    <rule ref="Generic.CodeAnalysis.UnnecessaryFinalModifier" />
    <rule ref="Generic.CodeAnalysis.UnusedFunctionParameter" />
    <rule ref="Generic.CodeAnalysis.UselessOverridingMethod" />
    <rule ref="Generic.CodeAnalysis.UnusedFunctionParameter.Found">
		<severity>0</severity>
    </rule>

    <!-- Misc tests -->
    <rule ref="Generic.Strings.UnnecessaryStringConcat" />
    <rule ref="Generic.Strings.UnnecessaryStringConcat.Found">
        <severity>0</severity>
    </rule>
    <rule ref="Generic.PHP.ForbiddenFunctions" />
    <rule ref="Generic.PHP.DeprecatedFunctions" />
    <rule ref="Generic.PHP.DeprecatedFunctions.Deprecated">
        <severity>0</severity>
    </rule>
    <rule ref="Generic.Functions.CallTimePassByReference" />
    <rule ref="Generic.NamingConventions.ConstructorName" />

    <!-- Tweaks to metrics -->
    <rule ref="Generic.Metrics.CyclomaticComplexity">
        <properties>
            <property name="complexity" value="80" />
            <property name="absoluteComplexity" value="200" />
        </properties>
    </rule>
    <rule ref="Generic.Metrics.NestingLevel">
        <properties>
            <property name="nestingLevel" value="10" />
            <property name="absoluteNestingLevel" value="50" />
        </properties>
    </rule>

</ruleset>
